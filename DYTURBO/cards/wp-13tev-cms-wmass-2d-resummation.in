# Process settings
sroot        = 13e3 # Center-of-mass energy
ih1          = 1    # Hadron 1: 1 for proton, -1 for antiproton
ih2          = 1    # Hadron 2: 1 for proton, -1 for antiproton
nproc        = 2    # Process: 1) W+; 2) W-; 3) Z/gamma*

# Perturbative order
fixedorder_only = false
order           = 2        # QCD order: 0) LO(+LL), 1) NLO(+NLL), 2) NNLO(+NNLL), 3) N3LO(+N3LL)
order_sudak  = 3
order_hcoef  = 2
order_evol  = 3
order_expc  = 3
order_ct  = 2
order_vjet  = 2

# PDF settings
LHAPDFset    = MSHT20nnlo_as118       # PDF set from LHAPDF
LHAPDFmember = 0              # PDF member
PDFerrors    = false                      # Calculate PDF errors

# Functional form of QCD scales (mV: wmass or zmass, pT: boson transverse momentum, mjj: dijet invariant mass)
#0: mu^2 = mV^2
#1: mu^2 = mll^2
#2: mu^2 = mll^2+pT^2
#3: mu^2 = mll^2+pT^2+mjj^2
#4: mu^2 = (pT + sqrt(mll^2+pT^2))^2
fmuren = 1     # Functional form of the renormalisation scale
fmufac = 1     # Functional form of the factorisation scale
fmures = 1     # Functional form of the resummation scale (forms >= 2 are equivalent to 1)

# QCD scale settings
kmuren = 1         # Scale factor for the renormalisation scale
kmufac = 1       # Scale factor for the factorisation scale
kmures = 1         # Scale factor for the resummation scale

#PDF matching scales
kmuc          = 1.        # Scale factor for the charm matching scale
kmub          = 1.        # Scale factor for the bottom matching scale
kmut          = 1.        # Scale factor for the top matching scale


# Resummation damping
damp = true

# Resummation damping function
# 1: Gaussian:    exp(-(k*mll-qt)^2)/(delta*mll)^2
# 2: Exponential: exp((k*mll)^-qt^2)/(delta*mll)^2
# 3: Cosine:      cos(PI/(delta*mll)*(qt-k*mll))+1)/2
dampmode = 1
dampk = 0.75
dampdelta = 0.5

# EW scheme
#0: Input: alpha(mZ), zmass, xw;     Derived: wmass, Gf
#1: Input: Gf, wmass, zmass;         Derived: xw, alpha(mZ)    [Gmu scheme]
#2: Input: Gf, alpha(mZ), xw, Gf;    Derived: wmass, zmass
#3: All masses and couplings determined by inputs
ewscheme = 1


# EW parameters
Gf    = 1.1663787e-5         # G-Fermi
zmass = 91.153509740726733              # Mass of the Z boson
wmass = 80.35181229                # Mass of the W boson
xw    = 0.22295787654160304              # Weak-mixing angle    (not used in the Gmu scheme)
aemz = 0.0075582087 # alpha_EM(MZ)         (not used in the Gmu scheme)

# W and Z total widths used in the propagator are determined by the following inputs
zwidth = 2.4932018986110700         # Width of the Z boson
wwidth = 2.0904310808144846         # Width of the W boson
runningwidth = false     # Use Z and W propagators including energy-dependent width effects

#CKM matrix
Vud = 0.97446
Vus = 0.222
Vub = 0.00365
Vcd = 0.22438
Vcs = 0.97359
Vcb = 0.04214
Vtd = 0.00896
Vts = 0.04133
Vtb = 0.999105


# Resummation parameters
qtcutoff = 0.02   # Resummation cutoff in GeV

# qt-subtraction cut-off. Both conditions are applied, at least one between qtcut and xqtcut must be > 0
xqtcut = 0.008  # cutoff on qt/m
qtcut = 0.      # cutoff on qt

# qt cut-off for the fiducial power corrections
qtfpc = 1e-4 # FPC cutoff on qt/m

# Integration settings
rseed        = 123456         # Random seed for MC integration

#mellin1d=true
evolmode=5
hfmode=2
orderlha=true
blim=1.5        
ncycle=40 


# Non-perturbative form factor, S_NP = exp(-npff(b))
# 0: Gaussian (BLNY)                 npff(b) = (g1 + g1x*(x1^g1a*(1-x1)^g1b + x2^g1a*(1-x2)^g1b) + g2*log(m/Q0) + g3*log(100*m/sqrt(s)))*b^2
# 1: Exponential                     npff(b) = e*b
# 2: Collins-Rogers                  npff(b) = g0*(1-exp(-(Cf*alphas(b0/bstar))*b^2)/(PI*g0*blim^2))*ln((m/Q0)^2)
# 3: Dokshitzer-Marchesini-Webber    npff(b) = exp(-(a2 * (log(m)+1.) - a2p) * b^2/2);
# 4: Pavia19
# 5: SV19
npff = 0

g1=0.8


# Term switches
doBORN = true
doCT   = true
doVJ   = false
doFPC  = false

doVJREAL = true
doVJVIRT = true

# Integration type: true -> quadrature, false -> vegas
BORNquad = true
CTquad   = true
VJquad   = true
FPCquad  = true

# Integration type (advanced settings, override BORNquad, CTquad, VJquad options if set > -1)
intDimRes = -1  # Resummed term (1, 2 or 3 for quadrature, or 4 for vegas)
intDimBorn = -1 # Born term (2 for quadrature, 4 or 6 for vegas)
intDimCT = -1   # Counter term (1, 2 or 3 for quadrature, or 6, or 8 for vegas)
intDimVJ = -1   # V+jet term (3 for quadrature, 5 for quadrature with cuts, or 7 for vegas)

# Multithreading parallelisation
cores         = 4   # Number of parallel threads (0 for turning off parallelisation)

# Cuba settings
cubaverbosity     = 0     # Cuba info messsages, from 0 to 3
cubanbatch        = 1000  # The batch size for sampling in Cuba vegas integration
niterBORN         = 5     # Only for 2d and 3d cuhre integration of resummed part
niterCT           = 5     # Only for 2d and 3d cuhre integration of counter term
niterVJ           = 10    # Only for 3d cuhre integration of V+J

#Vegas settings
#vegasncallsBORN   = 100000000     # only for res 4d vegas integration
#vegasncallsRES    = 1000     # only for res 4d vegas integration

vegasncallsBORN   = 100000     # only for res 4d vegas integration
vegasncallsRES    = 100000     # only for res 4d vegas integration
vegasncallsCT     = 100000   # only for 6d and 8d vegas integration of the counter term
vegasncallsVJLO   = 10000000 # only for lo 7d vegas integration
vegasncallsVJREAL = 1000000000 # only for real 10d vegas integration
vegasncallsVJVIRT = 100000000  # only for virt 8d vegas integration
vegascollect      = true    # collect points from all the vegas iterations (true) or only from the last iteration (false)

# cubature settings
pcubature = true   # Use Cuhre (false ) or pcubature (true) integration in quadrature mode
#relaccuracy = 0.001 #BORN # target relative uncertainty of each term
relaccuracy = 0.005 #CT # target relative uncertainty of each term
absaccuracy = 0.    # target absolute uncertainty of each term in fb

# Advanced integration settings

# Number of intervals and gaussian rule for the rapidity integrations in the 2dim resummed piece
yintervals = 1
yrule = 64

# Number of intervals and gaussian rule for the qt integration in the 2dim counter term
qtintervals = 1
qtrule = 64

# Number of intervals and gaussian rule for the alfa beta scaled-PDF integration in the counter term and born fixed order term
abintervals = 1
abrule = 64

# Gaussian rule for the phi integration in the V+J 5d LO term when makecuts is false
vjphirule = 20

# Settings for the z1, z2 integration in the V+J 3d NLO term
zrule = 64

# Settings for the x integration in the V+J 3d delta term
xrule = 200

# costh CS boundaries
costhmin = -1
costhmax = +1

# Lepton cuts
# Total cross section or with lepton cuts
makecuts = false

# charged leptons cuts
lptcut = 0
lycut = 1000 # absolute rapidity cut

# leptons and antileptons cuts
lepptcut = 0
lepycut = 1000
alpptcut = 0
alpycut = 1000

#absolute-rapidity-ordered leptons (central and forward)
lcptcut = 0
lcymin = 0
lcymax = 1000
lfptcut = 0
lfymin = 0
lfymax = 1000

# cuts on neutrino and transverse mass (these cuts are applied only in W processes)
etmisscut = 0
mtcut = 0

#costh CS
cthCSmin = -1
cthCSmax = +1

# integration types and settings for costh phi_lep phase space
cubaint   = false   # integration with Cuba Suave
trapezint = false  # trapezoidal rule for the phi_lep integration and semi-analytical for costh
quadint   = true  # quadrature rule for the phi_lep integration and semi-analytical for costh

suavepoints  = 1000000 # number of points for suave integration, newpoints is set to suavepoints/10;
nphitrape    = 1000    # number of steps for trapezoidal rule of phi_lep integration
phirule      = 4       # quadrature rule of phi_lep integration
phiintervals = 20      # number of segments for quadrature rule of phi_lep integration
ncstart      = 1000     # starting sampling for the costh semi-analytical integration (common settings for the trapezoidal and quadrature rules)


# Debug settings
timeprofile = false  # debug and time profile resummation integration
verbose     = false  # debug and time profile costh phi_lep integration

# Output settings
output_filename = results_wp-2d-resummation  # output filename
texttable   = true         # dump result table to text file
redirect    = false        # redirect stdout and stderr to log file (except for gridverbose output)
unicode     = true         # use unicode characters for the table formatting
silent      = false        # no output on screen (except for gridverbose output)
makehistos  = true         # fill histograms
gridverbose = false        # printout number of events to keep job alive when running on grid


# normalise cross sections by bin width
ptbinwidth = false
ybinwidth = false
mbinwidth = false

# Force to loop over all bins even you have all Vegas integrands
force_binsampling = true

# boson qt, y, m bins
qt_bins = [0. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 ]
#qt_bins = [51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100]
y_bins = [-5.00 -4.00 -3.75 -3.50 -3.25 -3.00 -2.75 -2.50 -2.25 -2.00 -1.75 -1.50 -1.25 -1.00 -0.75 -0.50 -0.25 0.00 0.25 0.50 0.75 1.00 1.25 1.50 1.75 2.00 2.25 2.50 2.75 3.00 3.25 3.50 3.75 4.00 5.00]


m_bins  = [ 1 13000 ]

# binning for user testing histogram
biganswer_bins = [ 41 42 43 ]
